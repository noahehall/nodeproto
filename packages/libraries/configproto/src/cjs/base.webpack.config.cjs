"use strict";

exports.__esModule = true;
exports.default = baseWebpackConfig;

var _bundleStatsWebpackPlugin = require("bundle-stats-webpack-plugin");

var _url = require("url");

const t = (msg = 'required', p = 'error in baseWebpackConfig: ') => {
  throw new Error(`${p}${msg}`);
};

const r = thing => t(`${thing} is required`);

const defaultPlugins = [new _bundleStatsWebpackPlugin.BundleStatsWebpackPlugin({
  baseline: false,
  compare: false,
  html: true,
  json: false,
  outDir: '../bundlestats',
  silent: false
})];

const generateLoaders = ({
  pathSrc,
  stringReplaceLoader
}) => ({
  cssExternalLoader: {
    test: /\.css$/,
    include: /node_modules/,
    use: ['style-loader', 'css-loader']
  },
  cssInternalLoader: {
    test: /\.css$/,
    exclude: /node_modules/,
    use: ['style-loader', 'css-loader']
  },
  esmLoader: {
    test: /\.m?js$/,
    type: 'javascript/auto',
    resolve: {
      fullySpecified: false
    }
  },
  fontLoader: {
    test: /\.(eot|otf|ttf|woff|woff2)$/,
    use: 'file-loader'
  },
  imageLoader: {
    test: /\.(jpg|png|gif)$/,
    use: [{
      loader: 'url-loader',
      options: {
        limit: 10 * 1024
      }
    }]
  },
  jsLoader: {
    exclude: /node_modules/,
    include: [pathSrc],
    test: /\.(c|m)?jsx?$/,
    type: 'javascript/auto',
    use: [{
      loader: 'babel-loader',
      options: {
        sourceType: "unambiguous",
        configFile: (0, _url.fileURLToPath)(new URL('../babel/flow.babelrc', import.meta.url))
      }
    }, stringReplaceLoader]
  },
  svgLoader: {
    test: /\.svg$/,
    use: [{
      loader: 'svg-url-loader',
      options: {
        limit: 10 * 1024,
        noquotes: true
      }
    }]
  },
  videoLoader: {
    test: /\.(mp4|webm)$/,
    use: {
      loader: 'url-loader',
      options: {
        limit: 10000
      }
    }
  }
});

function baseWebpackConfig({
  entry = r('entry: Array'),
  pack = {},
  builtinModules = pack.builtinModules || [],
  ifDev = pack.ifDev,
  ifProd = pack.ifProd,
  pathDist = pack.pathDist || r('pathDist: String'),
  pathSrc = pack.pathSrc || r('pathSrc: String'),
  pkgJson = pack.pkgJson || {},
  basePlugins = defaultPlugins,
  context = process.cwd(),
  entryPush = [],
  entryUnshift = [],
  extensions = ['.mjs', '.js', '.jsx', '.jsx', '.json'],
  externals = [],
  mainFields = ['module', 'browser', 'main'],
  mode = 'development',
  optimization = {},
  output = {},
  outputDefault = {
    filename: '[name].js',
    chunkFilename: '[name].chunk.js'
  },
  plugins = [],
  processEnv = {},
  publicPath = 'auto',
  stats = 'summary',
  target = 'web',
  devtool = ifProd ? 'hidden-source-map' : 'eval-cheap-module-source-map',
  stringReplaceLoader = {
    loader: 'string-replace-loader',
    options: {
      multiple: Object.entries(processEnv).map(([search, replace]) => ({
        search,
        replace
      }))
    }
  },
  ...overrides
} = {}) {
  return {
    context,
    devtool,
    entry: entryUnshift.concat(entry, entryPush).filter(e => e),
    externals: builtinModules.concat(externals),
    mode,
    module: {
      rules: Object.values(generateLoaders({
        pathSrc,
        stringReplaceLoader
      })).filter(x => x)
    },
    optimization,
    output: {
      path: pathDist,
      publicPath,
      ...outputDefault,
      ...output
    },
    plugins: plugins.concat(basePlugins).filter(x => x),
    resolve: {
      extensions,
      mainFields
    },
    stats,
    target,
    ...overrides
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3dlYnBhY2svYmFzZS53ZWJwYWNrLmNvbmZpZy5tanMiXSwibmFtZXMiOlsidCIsIm1zZyIsInAiLCJFcnJvciIsInIiLCJ0aGluZyIsImRlZmF1bHRQbHVnaW5zIiwiQnVuZGxlU3RhdHNXZWJwYWNrUGx1Z2luIiwiYmFzZWxpbmUiLCJjb21wYXJlIiwiaHRtbCIsImpzb24iLCJvdXREaXIiLCJzaWxlbnQiLCJnZW5lcmF0ZUxvYWRlcnMiLCJwYXRoU3JjIiwic3RyaW5nUmVwbGFjZUxvYWRlciIsImNzc0V4dGVybmFsTG9hZGVyIiwidGVzdCIsImluY2x1ZGUiLCJ1c2UiLCJjc3NJbnRlcm5hbExvYWRlciIsImV4Y2x1ZGUiLCJlc21Mb2FkZXIiLCJ0eXBlIiwicmVzb2x2ZSIsImZ1bGx5U3BlY2lmaWVkIiwiZm9udExvYWRlciIsImltYWdlTG9hZGVyIiwibG9hZGVyIiwib3B0aW9ucyIsImxpbWl0IiwianNMb2FkZXIiLCJzb3VyY2VUeXBlIiwiY29uZmlnRmlsZSIsIlVSTCIsImltcG9ydCIsIm1ldGEiLCJ1cmwiLCJzdmdMb2FkZXIiLCJub3F1b3RlcyIsInZpZGVvTG9hZGVyIiwiYmFzZVdlYnBhY2tDb25maWciLCJlbnRyeSIsInBhY2siLCJidWlsdGluTW9kdWxlcyIsImlmRGV2IiwiaWZQcm9kIiwicGF0aERpc3QiLCJwa2dKc29uIiwiYmFzZVBsdWdpbnMiLCJjb250ZXh0IiwicHJvY2VzcyIsImN3ZCIsImVudHJ5UHVzaCIsImVudHJ5VW5zaGlmdCIsImV4dGVuc2lvbnMiLCJleHRlcm5hbHMiLCJtYWluRmllbGRzIiwibW9kZSIsIm9wdGltaXphdGlvbiIsIm91dHB1dCIsIm91dHB1dERlZmF1bHQiLCJmaWxlbmFtZSIsImNodW5rRmlsZW5hbWUiLCJwbHVnaW5zIiwicHJvY2Vzc0VudiIsInB1YmxpY1BhdGgiLCJzdGF0cyIsInRhcmdldCIsImRldnRvb2wiLCJtdWx0aXBsZSIsIk9iamVjdCIsImVudHJpZXMiLCJtYXAiLCJzZWFyY2giLCJyZXBsYWNlIiwib3ZlcnJpZGVzIiwiY29uY2F0IiwiZmlsdGVyIiwiZSIsIm1vZHVsZSIsInJ1bGVzIiwidmFsdWVzIiwieCIsInBhdGgiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7O0FBQ0E7O0FBR0EsTUFBTUEsQ0FBQyxHQUFHLENBQUNDLEdBQUcsR0FBRyxVQUFQLEVBQW1CQyxDQUFDLEdBQUcsOEJBQXZCLEtBQTBEO0FBQUUsUUFBTSxJQUFJQyxLQUFKLENBQVcsR0FBRUQsQ0FBRSxHQUFFRCxHQUFJLEVBQXJCLENBQU47QUFBZ0MsQ0FBdEc7O0FBRUEsTUFBTUcsQ0FBQyxHQUFHQyxLQUFLLElBQUlMLENBQUMsQ0FBRSxHQUFFSyxLQUFNLGNBQVYsQ0FBcEI7O0FBRUEsTUFBTUMsY0FBYyxHQUFHLENBRXJCLElBQUlDLGtEQUFKLENBQTZCO0FBQzNCQyxFQUFBQSxRQUFRLEVBQUUsS0FEaUI7QUFFM0JDLEVBQUFBLE9BQU8sRUFBRSxLQUZrQjtBQUczQkMsRUFBQUEsSUFBSSxFQUFFLElBSHFCO0FBSTNCQyxFQUFBQSxJQUFJLEVBQUUsS0FKcUI7QUFLM0JDLEVBQUFBLE1BQU0sRUFBRSxnQkFMbUI7QUFNM0JDLEVBQUFBLE1BQU0sRUFBRTtBQU5tQixDQUE3QixDQUZxQixDQUF2Qjs7QUFZQSxNQUFNQyxlQUFlLEdBQUcsQ0FBQztBQUN2QkMsRUFBQUEsT0FEdUI7QUFFdkJDLEVBQUFBO0FBRnVCLENBQUQsTUFHakI7QUFDTEMsRUFBQUEsaUJBQWlCLEVBQUU7QUFDakJDLElBQUFBLElBQUksRUFBRSxRQURXO0FBRWpCQyxJQUFBQSxPQUFPLEVBQUUsY0FGUTtBQUdqQkMsSUFBQUEsR0FBRyxFQUFFLENBQ0gsY0FERyxFQUVILFlBRkc7QUFIWSxHQURkO0FBVUxDLEVBQUFBLGlCQUFpQixFQUFFO0FBQ2pCSCxJQUFBQSxJQUFJLEVBQUUsUUFEVztBQUVqQkksSUFBQUEsT0FBTyxFQUFFLGNBRlE7QUFHakJGLElBQUFBLEdBQUcsRUFBRSxDQUNILGNBREcsRUFFSCxZQUZHO0FBSFksR0FWZDtBQW9CTEcsRUFBQUEsU0FBUyxFQUFFO0FBQ1RMLElBQUFBLElBQUksRUFBRSxTQURHO0FBRVRNLElBQUFBLElBQUksRUFBRSxpQkFGRztBQUlUQyxJQUFBQSxPQUFPLEVBQUU7QUFBRUMsTUFBQUEsY0FBYyxFQUFFO0FBQWxCO0FBSkEsR0FwQk47QUEyQkxDLEVBQUFBLFVBQVUsRUFBRTtBQUNWVCxJQUFBQSxJQUFJLEVBQUUsNkJBREk7QUFFVkUsSUFBQUEsR0FBRyxFQUFFO0FBRkssR0EzQlA7QUFnQ0xRLEVBQUFBLFdBQVcsRUFBRTtBQUNYVixJQUFBQSxJQUFJLEVBQUUsa0JBREs7QUFFWEUsSUFBQUEsR0FBRyxFQUFFLENBQ0g7QUFDRVMsTUFBQUEsTUFBTSxFQUFFLFlBRFY7QUFFRUMsTUFBQUEsT0FBTyxFQUFFO0FBRVBDLFFBQUFBLEtBQUssRUFBRSxLQUFLO0FBRkw7QUFGWCxLQURHO0FBRk0sR0FoQ1I7QUE2Q0xDLEVBQUFBLFFBQVEsRUFBRTtBQUNSVixJQUFBQSxPQUFPLEVBQUUsY0FERDtBQUVSSCxJQUFBQSxPQUFPLEVBQUUsQ0FBQ0osT0FBRCxDQUZEO0FBR1JHLElBQUFBLElBQUksRUFBRSxlQUhFO0FBSVJNLElBQUFBLElBQUksRUFBRSxpQkFKRTtBQUtSSixJQUFBQSxHQUFHLEVBQUUsQ0FDSDtBQUNFUyxNQUFBQSxNQUFNLEVBQUUsY0FEVjtBQUVFQyxNQUFBQSxPQUFPLEVBQUU7QUFDUEcsUUFBQUEsVUFBVSxFQUFFLGFBREw7QUFHUEMsUUFBQUEsVUFBVSxFQUFFLHdCQUFjLElBQUlDLEdBQUosQ0FBUSx1QkFBUixFQUFpQ0MsTUFBTSxDQUFDQyxJQUFQLENBQVlDLEdBQTdDLENBQWQ7QUFITDtBQUZYLEtBREcsRUFTSHRCLG1CQVRHO0FBTEcsR0E3Q0w7QUErREx1QixFQUFBQSxTQUFTLEVBQUU7QUFDVHJCLElBQUFBLElBQUksRUFBRSxRQURHO0FBRVRFLElBQUFBLEdBQUcsRUFBRSxDQUNIO0FBQ0VTLE1BQUFBLE1BQU0sRUFBRSxnQkFEVjtBQUVFQyxNQUFBQSxPQUFPLEVBQUU7QUFFUEMsUUFBQUEsS0FBSyxFQUFFLEtBQUssSUFGTDtBQUdQUyxRQUFBQSxRQUFRLEVBQUU7QUFISDtBQUZYLEtBREc7QUFGSSxHQS9ETjtBQTZFTEMsRUFBQUEsV0FBVyxFQUFFO0FBQ1h2QixJQUFBQSxJQUFJLEVBQUUsZUFESztBQUVYRSxJQUFBQSxHQUFHLEVBQUU7QUFDSFMsTUFBQUEsTUFBTSxFQUFFLFlBREw7QUFFSEMsTUFBQUEsT0FBTyxFQUFFO0FBQ1BDLFFBQUFBLEtBQUssRUFBRTtBQURBO0FBRk47QUFGTTtBQTdFUixDQUhpQixDQUF4Qjs7QUFnR2UsU0FBU1csaUJBQVQsQ0FBNEI7QUFNekNDLEVBQUFBLEtBQUssR0FBR3ZDLENBQUMsQ0FBQyxjQUFELENBTmdDO0FBU3pDd0MsRUFBQUEsSUFBSSxHQUFHLEVBVGtDO0FBVXpDQyxFQUFBQSxjQUFjLEdBQUdELElBQUksQ0FBQ0MsY0FBTCxJQUF1QixFQVZDO0FBV3pDQyxFQUFBQSxLQUFLLEdBQUdGLElBQUksQ0FBQ0UsS0FYNEI7QUFZekNDLEVBQUFBLE1BQU0sR0FBR0gsSUFBSSxDQUFDRyxNQVoyQjtBQWF6Q0MsRUFBQUEsUUFBUSxHQUFHSixJQUFJLENBQUNJLFFBQUwsSUFBaUI1QyxDQUFDLENBQUMsa0JBQUQsQ0FiWTtBQWN6Q1csRUFBQUEsT0FBTyxHQUFHNkIsSUFBSSxDQUFDN0IsT0FBTCxJQUFnQlgsQ0FBQyxDQUFDLGlCQUFELENBZGM7QUFlekM2QyxFQUFBQSxPQUFPLEdBQUdMLElBQUksQ0FBQ0ssT0FBTCxJQUFnQixFQWZlO0FBa0J6Q0MsRUFBQUEsV0FBVyxHQUFHNUMsY0FsQjJCO0FBbUJ6QzZDLEVBQUFBLE9BQU8sR0FBR0MsT0FBTyxDQUFDQyxHQUFSLEVBbkIrQjtBQW9CekNDLEVBQUFBLFNBQVMsR0FBRyxFQXBCNkI7QUFxQnpDQyxFQUFBQSxZQUFZLEdBQUcsRUFyQjBCO0FBc0J6Q0MsRUFBQUEsVUFBVSxHQUFHLENBQUMsTUFBRCxFQUFRLEtBQVIsRUFBYyxNQUFkLEVBQXNCLE1BQXRCLEVBQTZCLE9BQTdCLENBdEI0QjtBQXVCekNDLEVBQUFBLFNBQVMsR0FBRyxFQXZCNkI7QUF3QnpDQyxFQUFBQSxVQUFVLEdBQUcsQ0FBQyxRQUFELEVBQVUsU0FBVixFQUFvQixNQUFwQixDQXhCNEI7QUF5QnpDQyxFQUFBQSxJQUFJLEdBQUcsYUF6QmtDO0FBMEJ6Q0MsRUFBQUEsWUFBWSxHQUFHLEVBMUIwQjtBQTJCekNDLEVBQUFBLE1BQU0sR0FBRyxFQTNCZ0M7QUE0QnpDQyxFQUFBQSxhQUFhLEdBQUc7QUFBRUMsSUFBQUEsUUFBUSxFQUFFLFdBQVo7QUFBeUJDLElBQUFBLGFBQWEsRUFBRTtBQUF4QyxHQTVCeUI7QUE2QnpDQyxFQUFBQSxPQUFPLEdBQUcsRUE3QitCO0FBOEJ6Q0MsRUFBQUEsVUFBVSxHQUFHLEVBOUI0QjtBQStCekNDLEVBQUFBLFVBQVUsR0FBRyxNQS9CNEI7QUFnQ3pDQyxFQUFBQSxLQUFLLEdBQUcsU0FoQ2lDO0FBaUN6Q0MsRUFBQUEsTUFBTSxHQUFHLEtBakNnQztBQW9DekNDLEVBQUFBLE9BQU8sR0FBR3ZCLE1BQU0sR0FBRyxtQkFBSCxHQUF5Qiw4QkFwQ0E7QUEwQ3pDL0IsRUFBQUEsbUJBQW1CLEdBQUc7QUFFcEJhLElBQUFBLE1BQU0sRUFBRSx1QkFGWTtBQUdwQkMsSUFBQUEsT0FBTyxFQUFFO0FBQ1B5QyxNQUFBQSxRQUFRLEVBQUVDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFlUCxVQUFmLEVBQTJCUSxHQUEzQixDQUErQixDQUFDLENBQ3hDQyxNQUR3QyxFQUV4Q0MsT0FGd0MsQ0FBRCxNQUdsQztBQUFFRCxRQUFBQSxNQUFGO0FBQVVDLFFBQUFBO0FBQVYsT0FIa0MsQ0FBL0I7QUFESDtBQUhXLEdBMUNtQjtBQXNEekMsS0FBR0M7QUF0RHNDLElBdUR2QyxFQXZEVyxFQXVEUDtBQUNOLFNBQU87QUFDTDFCLElBQUFBLE9BREs7QUFFTG1CLElBQUFBLE9BRks7QUFHTDNCLElBQUFBLEtBQUssRUFBRVksWUFBWSxDQUFDdUIsTUFBYixDQUFvQm5DLEtBQXBCLEVBQTJCVyxTQUEzQixFQUFzQ3lCLE1BQXRDLENBQTZDQyxDQUFDLElBQUlBLENBQWxELENBSEY7QUFJTHZCLElBQUFBLFNBQVMsRUFBRVosY0FBYyxDQUFDaUMsTUFBZixDQUFzQnJCLFNBQXRCLENBSk47QUFLTEUsSUFBQUEsSUFMSztBQU9Mc0IsSUFBQUEsTUFBTSxFQUFFO0FBQUVDLE1BQUFBLEtBQUssRUFBRVYsTUFBTSxDQUFDVyxNQUFQLENBQWNyRSxlQUFlLENBQUM7QUFBRUMsUUFBQUEsT0FBRjtBQUFXQyxRQUFBQTtBQUFYLE9BQUQsQ0FBN0IsRUFBaUUrRCxNQUFqRSxDQUF3RUssQ0FBQyxJQUFJQSxDQUE3RTtBQUFULEtBUEg7QUFRTHhCLElBQUFBLFlBUks7QUFTTEMsSUFBQUEsTUFBTSxFQUFFO0FBQ053QixNQUFBQSxJQUFJLEVBQUVyQyxRQURBO0FBRU5tQixNQUFBQSxVQUZNO0FBR04sU0FBR0wsYUFIRztBQUlOLFNBQUdEO0FBSkcsS0FUSDtBQWVMSSxJQUFBQSxPQUFPLEVBQUdBLE9BQU8sQ0FBQ2EsTUFBUixDQUFlNUIsV0FBZixDQUFELENBQThCNkIsTUFBOUIsQ0FBcUNLLENBQUMsSUFBSUEsQ0FBMUMsQ0FmSjtBQWdCTDNELElBQUFBLE9BQU8sRUFBRTtBQUFFK0IsTUFBQUEsVUFBRjtBQUFjRSxNQUFBQTtBQUFkLEtBaEJKO0FBaUJMVSxJQUFBQSxLQWpCSztBQWtCTEMsSUFBQUEsTUFsQks7QUFvQkwsT0FBR1E7QUFwQkUsR0FBUDtBQXNCRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEJ1bmRsZVN0YXRzV2VicGFja1BsdWdpbiB9IGZyb20gJ2J1bmRsZS1zdGF0cy13ZWJwYWNrLXBsdWdpbic7XG5pbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSAndXJsJztcblxuLy8gbGlrZWx5IG5vdCBuZWVkZWQgYXMgd2UgY29udGludWUgdG8gaW50ZWdyYXRlIGZsb3dcbmNvbnN0IHQgPSAobXNnID0gJ3JlcXVpcmVkJywgcCA9ICdlcnJvciBpbiBiYXNlV2VicGFja0NvbmZpZzogJykgPT4geyB0aHJvdyBuZXcgRXJyb3IoYCR7cH0ke21zZ31gKTsgfTtcblxuY29uc3QgciA9IHRoaW5nID0+IHQoYCR7dGhpbmd9IGlzIHJlcXVpcmVkYCk7XG5cbmNvbnN0IGRlZmF1bHRQbHVnaW5zID0gW1xuICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWxhdGl2ZS1jaS9idW5kbGUtc3RhdHMvdHJlZS9tYXN0ZXIvcGFja2FnZXMvd2VicGFjay1wbHVnaW5cbiAgbmV3IEJ1bmRsZVN0YXRzV2VicGFja1BsdWdpbih7XG4gICAgYmFzZWxpbmU6IGZhbHNlLFxuICAgIGNvbXBhcmU6IGZhbHNlLFxuICAgIGh0bWw6IHRydWUsXG4gICAganNvbjogZmFsc2UsXG4gICAgb3V0RGlyOiAnLi4vYnVuZGxlc3RhdHMnLFxuICAgIHNpbGVudDogZmFsc2UsXG4gIH0pLFxuXTtcblxuY29uc3QgZ2VuZXJhdGVMb2FkZXJzID0gKHtcbiAgcGF0aFNyYyxcbiAgc3RyaW5nUmVwbGFjZUxvYWRlcixcbn0pID0+ICh7XG4gIGNzc0V4dGVybmFsTG9hZGVyOiB7XG4gICAgdGVzdDogL1xcLmNzcyQvLFxuICAgIGluY2x1ZGU6IC9ub2RlX21vZHVsZXMvLFxuICAgIHVzZTogW1xuICAgICAgJ3N0eWxlLWxvYWRlcicsXG4gICAgICAnY3NzLWxvYWRlcidcbiAgICBdLFxuICB9LFxuXG4gIGNzc0ludGVybmFsTG9hZGVyOiB7XG4gICAgdGVzdDogL1xcLmNzcyQvLFxuICAgIGV4Y2x1ZGU6IC9ub2RlX21vZHVsZXMvLFxuICAgIHVzZTogW1xuICAgICAgJ3N0eWxlLWxvYWRlcicsXG4gICAgICAnY3NzLWxvYWRlcidcbiAgICBdLFxuICB9LFxuXG4gIC8vIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL3dlYnBhY2svd2VicGFjay9pc3N1ZXMvMTE0NjdcbiAgZXNtTG9hZGVyOiB7XG4gICAgdGVzdDogL1xcLm0/anMkLyxcbiAgICB0eXBlOiAnamF2YXNjcmlwdC9hdXRvJyxcbiAgICAvLyBpbmNsdWRlOiAvbm9kZV9tb2R1bGVzLyxcbiAgICByZXNvbHZlOiB7IGZ1bGx5U3BlY2lmaWVkOiBmYWxzZSB9LFxuICB9LFxuXG4gIGZvbnRMb2FkZXI6IHtcbiAgICB0ZXN0OiAvXFwuKGVvdHxvdGZ8dHRmfHdvZmZ8d29mZjIpJC8sXG4gICAgdXNlOiAnZmlsZS1sb2FkZXInLFxuICB9LFxuXG4gIGltYWdlTG9hZGVyOiB7XG4gICAgdGVzdDogL1xcLihqcGd8cG5nfGdpZikkLyxcbiAgICB1c2U6IFtcbiAgICAgIHtcbiAgICAgICAgbG9hZGVyOiAndXJsLWxvYWRlcicsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgLy8gSW5saW5lIGZpbGVzIHNtYWxsZXIgdGhhbiAxMCBrQlxuICAgICAgICAgIGxpbWl0OiAxMCAqIDEwMjQsXG4gICAgICAgIH0sXG4gICAgICB9XG4gICAgXSxcbiAgfSxcblxuICBqc0xvYWRlcjoge1xuICAgIGV4Y2x1ZGU6IC9ub2RlX21vZHVsZXMvLFxuICAgIGluY2x1ZGU6IFtwYXRoU3JjXSxcbiAgICB0ZXN0OiAvXFwuKGN8bSk/anN4PyQvLFxuICAgIHR5cGU6ICdqYXZhc2NyaXB0L2F1dG8nLFxuICAgIHVzZTogW1xuICAgICAge1xuICAgICAgICBsb2FkZXI6ICdiYWJlbC1sb2FkZXInLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgc291cmNlVHlwZTogXCJ1bmFtYmlndW91c1wiLFxuICAgICAgICAgIC8vIFRPRE86IGxpa2VseSB3b250IHdvcmsgd2l0aCBjanNcbiAgICAgICAgICBjb25maWdGaWxlOiBmaWxlVVJMVG9QYXRoKG5ldyBVUkwoJy4uL2JhYmVsL2Zsb3cuYmFiZWxyYycsIGltcG9ydC5tZXRhLnVybCkpXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgc3RyaW5nUmVwbGFjZUxvYWRlcixcbiAgICBdXG4gIH0sXG5cbiAgc3ZnTG9hZGVyOiB7XG4gICAgdGVzdDogL1xcLnN2ZyQvLFxuICAgIHVzZTogW1xuICAgICAge1xuICAgICAgICBsb2FkZXI6ICdzdmctdXJsLWxvYWRlcicsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgLy8gSW5saW5lIGZpbGVzIHNtYWxsZXIgdGhhbiAxMCBrQlxuICAgICAgICAgIGxpbWl0OiAxMCAqIDEwMjQsXG4gICAgICAgICAgbm9xdW90ZXM6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9XG4gICAgXSxcbiAgfSxcblxuICB2aWRlb0xvYWRlcjoge1xuICAgIHRlc3Q6IC9cXC4obXA0fHdlYm0pJC8sXG4gICAgdXNlOiB7XG4gICAgICBsb2FkZXI6ICd1cmwtbG9hZGVyJyxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgbGltaXQ6IDEwMDAwLFxuICAgICAgfSxcbiAgICB9LFxuICB9LFxufSk7XG5cbi8qKlxuICpcbiAqIEBwYXJhbSBvcHRpb25zIGV2ZXJ5dGhpbmcgaXMgY29uZmlndXJhYmxlXG4gKiBAcmV0dXJucyB3ZWJwYWNrIGNvbmZpZ3VyYXRpb24gb2JqZWN0XG4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGJhc2VXZWJwYWNrQ29uZmlnICh7XG4gIC8vIGRlZmF1bHRzXG4gIC8vIGV4dGVybmFsc0NvbmZpZyA9IHsgbW9kdWxlc0Zyb21GaWxlOiB0cnVlIH0sIC8vIHZlcmlmeSB0aGlzXG4gIC8vIHNpZGVFZmZlY3RzID0gWycuL2FwcC9jb21wb25lbnRzLyoqLyouanMnLCAnKi5jc3MnXSwgZG9lc250IHdvcmsgbGlrZSBpbiBwa2dqc29uLCBrZWVwIHRoaXMgY29tbWVudFxuXG4gIC8vIHJlcXVpcmVkXG4gIGVudHJ5ID0gcignZW50cnk6IEFycmF5JyksXG5cbiAgLy8gcHJvdmlkZWQgYnkgcGFjaywgYnV0IHN0aWxsIG92ZXJyaWRhYmxlXG4gIHBhY2sgPSB7fSwgLy8gcHJvdmlkZWQgYnkgc2V0dXAud2VicGFjay5jb25maWcubWpzXG4gIGJ1aWx0aW5Nb2R1bGVzID0gcGFjay5idWlsdGluTW9kdWxlcyB8fCBbXSwgLy8gVE9ETzogdXBkYXRlIHRlc3RzIHRoaXMgc2hvdWxkbnQgYmUgcmVxdWlyZWRcbiAgaWZEZXYgPSBwYWNrLmlmRGV2LFxuICBpZlByb2QgPSBwYWNrLmlmUHJvZCxcbiAgcGF0aERpc3QgPSBwYWNrLnBhdGhEaXN0IHx8IHIoJ3BhdGhEaXN0OiBTdHJpbmcnKSxcbiAgcGF0aFNyYyA9IHBhY2sucGF0aFNyYyB8fCByKCdwYXRoU3JjOiBTdHJpbmcnKSxcbiAgcGtnSnNvbiA9IHBhY2sucGtnSnNvbiB8fCB7fSxcblxuICAvLyBvdGhlciBzaGl0XG4gIGJhc2VQbHVnaW5zID0gZGVmYXVsdFBsdWdpbnMsXG4gIGNvbnRleHQgPSBwcm9jZXNzLmN3ZCgpLFxuICBlbnRyeVB1c2ggPSBbXSxcbiAgZW50cnlVbnNoaWZ0ID0gW10sXG4gIGV4dGVuc2lvbnMgPSBbJy5tanMnLCcuanMnLCcuanN4JywgJy5qc3gnLCcuanNvbiddLFxuICBleHRlcm5hbHMgPSBbXSxcbiAgbWFpbkZpZWxkcyA9IFsnbW9kdWxlJywnYnJvd3NlcicsJ21haW4nXSwgLy8gVE9ETzogY29uZmlybSB0aGlzXG4gIG1vZGUgPSAnZGV2ZWxvcG1lbnQnLFxuICBvcHRpbWl6YXRpb24gPSB7fSxcbiAgb3V0cHV0ID0ge30sXG4gIG91dHB1dERlZmF1bHQgPSB7IGZpbGVuYW1lOiAnW25hbWVdLmpzJywgY2h1bmtGaWxlbmFtZTogJ1tuYW1lXS5jaHVuay5qcycgfSxcbiAgcGx1Z2lucyA9IFtdLFxuICBwcm9jZXNzRW52ID0ge30sXG4gIHB1YmxpY1BhdGggPSAnYXV0bycsIC8vIEBzZWUgaHR0cHM6Ly93ZWJwYWNrLmpzLm9yZy9ndWlkZXMvcHVibGljLXBhdGgvI2F1dG9tYXRpYy1wdWJsaWNwYXRoXG4gIHN0YXRzID0gJ3N1bW1hcnknLFxuICB0YXJnZXQgPSAnd2ViJyxcblxuICAvLyBkZXBlbmRlbnQxXG4gIGRldnRvb2wgPSBpZlByb2QgPyAnaGlkZGVuLXNvdXJjZS1tYXAnIDogJ2V2YWwtY2hlYXAtbW9kdWxlLXNvdXJjZS1tYXAnLFxuICAvLyBkZXBzID0gT2JqZWN0LmtleXMocGtnSnNvbi5kZXBlbmRlbmNpZXMgfHwge30pLFxuICAvLyBwZWVyRGVwcyA9IE9iamVjdC5rZXlzKHBrZ0pzb24ucGVlckRlcGVuZGVuY2llcyB8fCB7fSksXG5cbiAgLy8gbG9hZGVyc1xuICAvLyBzaG91bGQgYWx3YXlzIGJlIGxhc3QgdG8gdXNlIGRlZmF1bHRzIGFuZCBkZXBlbmRlbnRzXG4gIHN0cmluZ1JlcGxhY2VMb2FkZXIgPSB7XG4gICAgLy8gdGVzdDogL1xcLihodG1sfG0/anMpJC8sIC8vIGRvZXNudCB3b3JrIHdoZW4gcGFydCBvZiB1c2U6IFtdXG4gICAgbG9hZGVyOiAnc3RyaW5nLXJlcGxhY2UtbG9hZGVyJywgLy8gd2UgdXNlIHRoaXMgaW5zdGVhZCBvZiBkb3RlbnYtd2VicGFja1xuICAgIG9wdGlvbnM6IHtcbiAgICAgIG11bHRpcGxlOiBPYmplY3QuZW50cmllcyhwcm9jZXNzRW52KS5tYXAoKFtcbiAgICAgICAgc2VhcmNoLFxuICAgICAgICByZXBsYWNlXG4gICAgICBdKSA9PiAoeyBzZWFyY2gsIHJlcGxhY2UgfSkpXG4gICAgfVxuICB9LFxuXG4gIC8vIG92ZXJyaWRlcyB0b3AgbGV2ZWwgcHJvcGVydGllc1xuICAuLi5vdmVycmlkZXNcbn0gPSB7fSkge1xuICByZXR1cm4ge1xuICAgIGNvbnRleHQsXG4gICAgZGV2dG9vbCxcbiAgICBlbnRyeTogZW50cnlVbnNoaWZ0LmNvbmNhdChlbnRyeSwgZW50cnlQdXNoKS5maWx0ZXIoZSA9PiBlKSxcbiAgICBleHRlcm5hbHM6IGJ1aWx0aW5Nb2R1bGVzLmNvbmNhdChleHRlcm5hbHMpLFxuICAgIG1vZGUsXG4gICAgLy8gdXNlIHRvIGJlIFtnZW5lcmF0ZUxvYWRlcnMuLi5dXG4gICAgbW9kdWxlOiB7IHJ1bGVzOiBPYmplY3QudmFsdWVzKGdlbmVyYXRlTG9hZGVycyh7IHBhdGhTcmMsIHN0cmluZ1JlcGxhY2VMb2FkZXIgfSkpLmZpbHRlcih4ID0+IHgpIH0sXG4gICAgb3B0aW1pemF0aW9uLFxuICAgIG91dHB1dDoge1xuICAgICAgcGF0aDogcGF0aERpc3QsXG4gICAgICBwdWJsaWNQYXRoLFxuICAgICAgLi4ub3V0cHV0RGVmYXVsdCxcbiAgICAgIC4uLm91dHB1dCxcbiAgICB9LFxuICAgIHBsdWdpbnM6IChwbHVnaW5zLmNvbmNhdChiYXNlUGx1Z2lucykpLmZpbHRlcih4ID0+IHgpLFxuICAgIHJlc29sdmU6IHsgZXh0ZW5zaW9ucywgbWFpbkZpZWxkcyB9LFxuICAgIHN0YXRzLFxuICAgIHRhcmdldCxcblxuICAgIC4uLm92ZXJyaWRlcyxcbiAgfTtcbn1cbiJdfQ==