"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;

exports.__esModule = true;
exports.default = mikeTysonPunchOut;

var pack = _interopRequireDefault(require("./webpack.setup.mjs"));

var _bundleStatsWebpackPlugin = require("bundle-stats-webpack-plugin");

const defaultPlugins = [// @see https://github.com/relative-ci/bundle-stats/tree/master/packages/webpack-plugin
new _bundleStatsWebpackPlugin.BundleStatsWebpackPlugin({
  compare: false,
  baseline: false,
  html: true,
  json: false,
  outDir: '../bundlestats',
  silent: false
})];
/**
 *
 * @param options everything is configurable
 * @returns webpack configuration object
 */

function mikeTysonPunchOut({
  // defaults
  // externalsConfig = { modulesFromFile: true },
  // sideEffects = ['./app/components/**/*.js', '*.css'], doesnt work like in pkgjson,
  babelConfig = pack.babelConfigDefault(),
  context = pack.context,
  devtool = pack.ifProd ? 'hidden-source-map' : 'eval-cheap-module-source-map',
  entryPush = [],
  entryUnshift = [],
  env = pack.env,
  extensions = ['.mjs', '.js', '.jsx', '.json'],
  externals = [],
  ifDev = pack.ifDev,
  ifProd = pack.ifProd,
  mainFields = ['module', 'browser', 'main'],
  mode = pack.mode,
  optimization = pack.optimization,
  output = {},
  outputDefault = {
    filename: '[name].js',
    chunkFilename: '[name].chunk.js'
  },
  pathDist = pack.pathDist,
  pathSrc = pack.pathSrc,
  plugins = [],
  basePlugins = defaultPlugins,
  publicPath = '/',
  stats = 'summary',
  target = 'web',
  // dependent1
  deps = Object.keys(env.dependencies || {}),
  entry = [env.config.REACT_APP_FILE],
  peerDeps = Object.keys(env.peerDependencies || {}),
  // loaders
  // should always be last to use defaults and dependents
  stringReplaceLoader = {
    // test: /\.(html|m?js)$/,
    loader: 'string-replace-loader',
    // we use this instead of dotenv-webpack
    options: {
      multiple: Object.entries(env.processEnv).map(([search, replace]) => ({
        search,
        replace
      }))
    }
  },
  // @see https://github.com/webpack/webpack/issues/11467
  esmLoader = {
    test: /\.m?js$/,
    type: 'javascript/auto',
    // include: /node_modules/,
    resolve: {
      fullySpecified: false
    }
  },
  jsLoader = {
    test: /\.m?js$/,
    type: 'javascript/auto',
    include: [pathSrc],
    use: [{
      loader: 'babel-loader',
      options: babelConfig
    }, stringReplaceLoader]
  },
  cssInternalLoader = {
    test: /\.css$/,
    exclude: /node_modules/,
    use: ['style-loader', 'css-loader']
  },
  cssExternalLoader = {
    test: /\.css$/,
    include: /node_modules/,
    use: ['style-loader', 'css-loader']
  },
  fontLoader = {
    test: /\.(eot|otf|ttf|woff|woff2)$/,
    use: 'file-loader'
  },
  svgLoader = {
    test: /\.svg$/,
    use: [{
      loader: 'svg-url-loader',
      options: {
        // Inline files smaller than 10 kB
        limit: 10 * 1024,
        noquotes: true
      }
    }]
  },
  imageLoader = {
    test: /\.(jpg|png|gif)$/,
    use: [{
      loader: 'url-loader',
      options: {
        // Inline files smaller than 10 kB
        limit: 10 * 1024
      }
    }]
  },
  videoLoader = {
    test: /\.(mp4|webm)$/,
    use: {
      loader: 'url-loader',
      options: {
        limit: 10000
      }
    }
  },
  // overrides top level properties
  ...overrides
} = {}) {
  if (!entry.length) throw `${msg} no enty specified`;
  return {
    context,
    devtool,
    entry: entryUnshift.concat(entry, entryPush).filter(e => e),
    externals: pack.builtinModules.concat(externals),
    mode,
    optimization,
    plugins: plugins.concat(basePlugins).filter(x => x),
    resolve: {
      extensions,
      mainFields
    },
    stats,
    target,
    output: {
      path: pathDist,
      publicPath,
      ...outputDefault,
      ...output
    },
    module: {
      rules: [esmLoader, jsLoader, cssInternalLoader, cssExternalLoader, fontLoader, svgLoader, imageLoader, videoLoader].filter(x => x)
    },
    ...overrides
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3dlYnBhY2svYmFzZS53ZWJwYWNrLmNvbmZpZy5tanMiXSwibmFtZXMiOlsiZGVmYXVsdFBsdWdpbnMiLCJCdW5kbGVTdGF0c1dlYnBhY2tQbHVnaW4iLCJjb21wYXJlIiwiYmFzZWxpbmUiLCJodG1sIiwianNvbiIsIm91dERpciIsInNpbGVudCIsIm1pa2VUeXNvblB1bmNoT3V0IiwiYmFiZWxDb25maWciLCJwYWNrIiwiYmFiZWxDb25maWdEZWZhdWx0IiwiY29udGV4dCIsImRldnRvb2wiLCJpZlByb2QiLCJlbnRyeVB1c2giLCJlbnRyeVVuc2hpZnQiLCJlbnYiLCJleHRlbnNpb25zIiwiZXh0ZXJuYWxzIiwiaWZEZXYiLCJtYWluRmllbGRzIiwibW9kZSIsIm9wdGltaXphdGlvbiIsIm91dHB1dCIsIm91dHB1dERlZmF1bHQiLCJmaWxlbmFtZSIsImNodW5rRmlsZW5hbWUiLCJwYXRoRGlzdCIsInBhdGhTcmMiLCJwbHVnaW5zIiwiYmFzZVBsdWdpbnMiLCJwdWJsaWNQYXRoIiwic3RhdHMiLCJ0YXJnZXQiLCJkZXBzIiwiT2JqZWN0Iiwia2V5cyIsImRlcGVuZGVuY2llcyIsImVudHJ5IiwiY29uZmlnIiwiUkVBQ1RfQVBQX0ZJTEUiLCJwZWVyRGVwcyIsInBlZXJEZXBlbmRlbmNpZXMiLCJzdHJpbmdSZXBsYWNlTG9hZGVyIiwibG9hZGVyIiwib3B0aW9ucyIsIm11bHRpcGxlIiwiZW50cmllcyIsInByb2Nlc3NFbnYiLCJtYXAiLCJzZWFyY2giLCJyZXBsYWNlIiwiZXNtTG9hZGVyIiwidGVzdCIsInR5cGUiLCJyZXNvbHZlIiwiZnVsbHlTcGVjaWZpZWQiLCJqc0xvYWRlciIsImluY2x1ZGUiLCJ1c2UiLCJjc3NJbnRlcm5hbExvYWRlciIsImV4Y2x1ZGUiLCJjc3NFeHRlcm5hbExvYWRlciIsImZvbnRMb2FkZXIiLCJzdmdMb2FkZXIiLCJsaW1pdCIsIm5vcXVvdGVzIiwiaW1hZ2VMb2FkZXIiLCJ2aWRlb0xvYWRlciIsIm92ZXJyaWRlcyIsImxlbmd0aCIsIm1zZyIsImNvbmNhdCIsImZpbHRlciIsImUiLCJidWlsdGluTW9kdWxlcyIsIngiLCJwYXRoIiwibW9kdWxlIiwicnVsZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxjQUFjLEdBQUcsQ0FDckI7QUFDQSxJQUFJQyxrREFBSixDQUE2QjtBQUMzQkMsRUFBQUEsT0FBTyxFQUFFLEtBRGtCO0FBRTNCQyxFQUFBQSxRQUFRLEVBQUUsS0FGaUI7QUFHM0JDLEVBQUFBLElBQUksRUFBRSxJQUhxQjtBQUkzQkMsRUFBQUEsSUFBSSxFQUFFLEtBSnFCO0FBSzNCQyxFQUFBQSxNQUFNLEVBQUUsZ0JBTG1CO0FBTTNCQyxFQUFBQSxNQUFNLEVBQUU7QUFObUIsQ0FBN0IsQ0FGcUIsQ0FBdkI7QUFZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNlLFNBQVNDLGlCQUFULENBQTRCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBQyxFQUFBQSxXQUFXLEdBQUdDLElBQUksQ0FBQ0Msa0JBQUwsRUFKMkI7QUFLekNDLEVBQUFBLE9BQU8sR0FBR0YsSUFBSSxDQUFDRSxPQUwwQjtBQU16Q0MsRUFBQUEsT0FBTyxHQUFHSCxJQUFJLENBQUNJLE1BQUwsR0FBYyxtQkFBZCxHQUFvQyw4QkFOTDtBQU96Q0MsRUFBQUEsU0FBUyxHQUFHLEVBUDZCO0FBUXpDQyxFQUFBQSxZQUFZLEdBQUcsRUFSMEI7QUFTekNDLEVBQUFBLEdBQUcsR0FBR1AsSUFBSSxDQUFDTyxHQVQ4QjtBQVV6Q0MsRUFBQUEsVUFBVSxHQUFHLENBQ1gsTUFEVyxFQUVYLEtBRlcsRUFHWCxNQUhXLEVBSVgsT0FKVyxDQVY0QjtBQWdCekNDLEVBQUFBLFNBQVMsR0FBRyxFQWhCNkI7QUFpQnpDQyxFQUFBQSxLQUFLLEdBQUdWLElBQUksQ0FBQ1UsS0FqQjRCO0FBa0J6Q04sRUFBQUEsTUFBTSxHQUFHSixJQUFJLENBQUNJLE1BbEIyQjtBQW1CekNPLEVBQUFBLFVBQVUsR0FBRyxDQUNYLFFBRFcsRUFFWCxT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QUFPLEVBQUdBLE9BQU8sQ0FBQzJDLE1BQVIsQ0FBZTFDLFdBQWYsQ0FBRCxDQUE4QjJDLE1BQTlCLENBQXFDRyxDQUFDLElBQUlBLENBQTFDLENBUEo7QUFRTHJCLElBQUFBLE9BQU8sRUFBRTtBQUFFdEMsTUFBQUEsVUFBRjtBQUFjRyxNQUFBQTtBQUFkLEtBUko7QUFTTFksSUFBQUEsS0FUSztBQVVMQyxJQUFBQSxNQVZLO0FBWUxWLElBQUFBLE1BQU0sRUFBRTtBQUNOc0QsTUFBQUEsSUFBSSxFQUFFbEQsUUFEQTtBQUVOSSxNQUFBQSxVQUZNO0FBR04sU0FBR1AsYUFIRztBQUlOLFNBQUdEO0FBSkcsS0FaSDtBQW1CTHVELElBQUFBLE1BQU0sRUFBRTtBQUNOQyxNQUFBQSxLQUFLLEVBQUUsQ0FDTDNCLFNBREssRUFFTEssUUFGSyxFQUdMRyxpQkFISyxFQUlMRSxpQkFKSyxFQUtMQyxVQUxLLEVBTUxDLFNBTkssRUFPTEcsV0FQSyxFQVFMQyxXQVJLLEVBU0xLLE1BVEssQ0FTRUcsQ0FBQyxJQUFJQSxDQVRQO0FBREQsS0FuQkg7QUFnQ0wsT0FBR1A7QUFoQ0UsR0FBUDtBQWtDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHBhY2sgZnJvbSAnLi93ZWJwYWNrLnNldHVwLm1qcyc7XG5pbXBvcnQgeyBCdW5kbGVTdGF0c1dlYnBhY2tQbHVnaW4gfSBmcm9tICdidW5kbGUtc3RhdHMtd2VicGFjay1wbHVnaW4nO1xuXG5jb25zdCBkZWZhdWx0UGx1Z2lucyA9IFtcbiAgLy8gQHNlZSBodHRwczovL2dpdGh1Yi5jb20vcmVsYXRpdmUtY2kvYnVuZGxlLXN0YXRzL3RyZWUvbWFzdGVyL3BhY2thZ2VzL3dlYnBhY2stcGx1Z2luXG4gIG5ldyBCdW5kbGVTdGF0c1dlYnBhY2tQbHVnaW4oe1xuICAgIGNvbXBhcmU6IGZhbHNlLFxuICAgIGJhc2VsaW5lOiBmYWxzZSxcbiAgICBodG1sOiB0cnVlLFxuICAgIGpzb246IGZhbHNlLFxuICAgIG91dERpcjogJy4uL2J1bmRsZXN0YXRzJyxcbiAgICBzaWxlbnQ6IGZhbHNlLFxuICB9KVxuXTtcblxuLyoqXG4gKlxuICogQHBhcmFtIG9wdGlvbnMgZXZlcnl0aGluZyBpcyBjb25maWd1cmFibGVcbiAqIEByZXR1cm5zIHdlYnBhY2sgY29uZmlndXJhdGlvbiBvYmplY3RcbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWlrZVR5c29uUHVuY2hPdXQgKHtcbiAgLy8gZGVmYXVsdHNcbiAgLy8gZXh0ZXJuYWxzQ29uZmlnID0geyBtb2R1bGVzRnJvbUZpbGU6IHRydWUgfSxcbiAgLy8gc2lkZUVmZmVjdHMgPSBbJy4vYXBwL2NvbXBvbmVudHMvKiovKi5qcycsICcqLmNzcyddLCBkb2VzbnQgd29yayBsaWtlIGluIHBrZ2pzb24sXG4gIGJhYmVsQ29uZmlnID0gcGFjay5iYWJlbENvbmZpZ0RlZmF1bHQoKSxcbiAgY29udGV4dCA9IHBhY2suY29udGV4dCxcbiAgZGV2dG9vbCA9IHBhY2suaWZQcm9kID8gJ2hpZGRlbi1zb3VyY2UtbWFwJyA6ICdldmFsLWNoZWFwLW1vZHVsZS1zb3VyY2UtbWFwJyxcbiAgZW50cnlQdXNoID0gW10sXG4gIGVudHJ5VW5zaGlmdCA9IFtdLFxuICBlbnYgPSBwYWNrLmVudixcbiAgZXh0ZW5zaW9ucyA9IFtcbiAgICAnLm1qcycsXG4gICAgJy5qcycsXG4gICAgJy5qc3gnLFxuICAgICcuanNvbidcbiAgXSxcbiAgZXh0ZXJuYWxzID0gW10sXG4gIGlmRGV2ID0gcGFjay5pZkRldixcbiAgaWZQcm9kID0gcGFjay5pZlByb2QsXG4gIG1haW5GaWVsZHMgPSBbXG4gICAgJ21vZHVsZScsXG4gICAgJ2Jyb3dzZXInLFxuICAgICdtYWluJ1xuICBdLFxuICBtb2RlID0gcGFjay5tb2RlLFxuICBvcHRpbWl6YXRpb24gPSBwYWNrLm9wdGltaXphdGlvbixcbiAgb3V0cHV0ID0ge30sXG4gIG91dHB1dERlZmF1bHQgPSB7IGZpbGVuYW1lOiAnW25hbWVdLmpzJywgY2h1bmtGaWxlbmFtZTogJ1tuYW1lXS5jaHVuay5qcycgfSxcbiAgcGF0aERpc3QgPSBwYWNrLnBhdGhEaXN0LFxuICBwYXRoU3JjID0gcGFjay5wYXRoU3JjLFxuICBwbHVnaW5zID0gW10sXG4gIGJhc2VQbHVnaW5zID0gZGVmYXVsdFBsdWdpbnMsXG4gIHB1YmxpY1BhdGggPSAnLycsXG4gIHN0YXRzID0gJ3N1bW1hcnknLFxuICB0YXJnZXQgPSAnd2ViJyxcblxuICAvLyBkZXBlbmRlbnQxXG4gIGRlcHMgPSBPYmplY3Qua2V5cyhlbnYuZGVwZW5kZW5jaWVzIHx8IHt9KSxcbiAgZW50cnkgPSBbZW52LmNvbmZpZy5SRUFDVF9BUFBfRklMRV0sXG4gIHBlZXJEZXBzID0gT2JqZWN0LmtleXMoZW52LnBlZXJEZXBlbmRlbmNpZXMgfHwge30pLFxuXG4gIC8vIGxvYWRlcnNcbiAgLy8gc2hvdWxkIGFsd2F5cyBiZSBsYXN0IHRvIHVzZSBkZWZhdWx0cyBhbmQgZGVwZW5kZW50c1xuICBzdHJpbmdSZXBsYWNlTG9hZGVyID0ge1xuICAgIC8vIHRlc3Q6IC9cXC4oaHRtbHxtP2pzKSQvLFxuICAgIGxvYWRlcjogJ3N0cmluZy1yZXBsYWNlLWxvYWRlcicsIC8vIHdlIHVzZSB0aGlzIGluc3RlYWQgb2YgZG90ZW52LXdlYnBhY2tcbiAgICBvcHRpb25zOiB7XG4gICAgICBtdWx0aXBsZTogT2JqZWN0LmVudHJpZXMoZW52LnByb2Nlc3NFbnYpLm1hcCgoW1xuICAgICAgICBzZWFyY2gsXG4gICAgICAgIHJlcGxhY2VcbiAgICAgIF0pID0+ICh7IHNlYXJjaCwgcmVwbGFjZSB9KSlcbiAgICB9XG5cbiAgfSxcblxuICAvLyBAc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93ZWJwYWNrL3dlYnBhY2svaXNzdWVzLzExNDY3XG4gIGVzbUxvYWRlciA9IHtcbiAgICB0ZXN0OiAvXFwubT9qcyQvLFxuICAgIHR5cGU6ICdqYXZhc2NyaXB0L2F1dG8nLFxuICAgIC8vIGluY2x1ZGU6IC9ub2RlX21vZHVsZXMvLFxuICAgIHJlc29sdmU6IHsgZnVsbHlTcGVjaWZpZWQ6IGZhbHNlIH0sXG4gIH0sXG5cbiAganNMb2FkZXIgPSB7XG4gICAgdGVzdDogL1xcLm0/anMkLyxcbiAgICB0eXBlOiAnamF2YXNjcmlwdC9hdXRvJyxcbiAgICBpbmNsdWRlOiBbcGF0aFNyY10sXG4gICAgdXNlOiBbXG4gICAgICB7IGxvYWRlcjogJ2JhYmVsLWxvYWRlcicsIG9wdGlvbnM6IGJhYmVsQ29uZmlnIH0sXG4gICAgICBzdHJpbmdSZXBsYWNlTG9hZGVyLFxuICAgIF1cbiAgfSxcblxuICBjc3NJbnRlcm5hbExvYWRlciA9IHtcbiAgICB0ZXN0OiAvXFwuY3NzJC8sXG4gICAgZXhjbHVkZTogL25vZGVfbW9kdWxlcy8sXG4gICAgdXNlOiBbXG4gICAgICAnc3R5bGUtbG9hZGVyJyxcbiAgICAgICdjc3MtbG9hZGVyJ1xuICAgIF0sXG4gIH0sXG5cbiAgY3NzRXh0ZXJuYWxMb2FkZXIgPSB7XG4gICAgdGVzdDogL1xcLmNzcyQvLFxuICAgIGluY2x1ZGU6IC9ub2RlX21vZHVsZXMvLFxuICAgIHVzZTogW1xuICAgICAgJ3N0eWxlLWxvYWRlcicsXG4gICAgICAnY3NzLWxvYWRlcidcbiAgICBdLFxuICB9LFxuXG4gIGZvbnRMb2FkZXIgPSB7XG4gICAgdGVzdDogL1xcLihlb3R8b3RmfHR0Znx3b2ZmfHdvZmYyKSQvLFxuICAgIHVzZTogJ2ZpbGUtbG9hZGVyJyxcbiAgfSxcblxuICBzdmdMb2FkZXIgPSB7XG4gICAgdGVzdDogL1xcLnN2ZyQvLFxuICAgIHVzZTogW1xuICAgICAge1xuICAgICAgICBsb2FkZXI6ICdzdmctdXJsLWxvYWRlcicsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgLy8gSW5saW5lIGZpbGVzIHNtYWxsZXIgdGhhbiAxMCBrQlxuICAgICAgICAgIGxpbWl0OiAxMCAqIDEwMjQsXG4gICAgICAgICAgbm9xdW90ZXM6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICB9XG4gICAgXSxcbiAgfSxcblxuICBpbWFnZUxvYWRlciA9IHtcbiAgICB0ZXN0OiAvXFwuKGpwZ3xwbmd8Z2lmKSQvLFxuICAgIHVzZTogW1xuICAgICAge1xuICAgICAgICBsb2FkZXI6ICd1cmwtbG9hZGVyJyxcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAvLyBJbmxpbmUgZmlsZXMgc21hbGxlciB0aGFuIDEwIGtCXG4gICAgICAgICAgbGltaXQ6IDEwICogMTAyNCxcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICBdLFxuICB9LFxuXG4gIHZpZGVvTG9hZGVyID0ge1xuICAgIHRlc3Q6IC9cXC4obXA0fHdlYm0pJC8sXG4gICAgdXNlOiB7XG4gICAgICBsb2FkZXI6ICd1cmwtbG9hZGVyJyxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgbGltaXQ6IDEwMDAwLFxuICAgICAgfSxcbiAgICB9LFxuICB9LFxuXG4gIC8vIG92ZXJyaWRlcyB0b3AgbGV2ZWwgcHJvcGVydGllc1xuICAuLi5vdmVycmlkZXNcbn0gPSB7fSkge1xuICBpZiAoIWVudHJ5Lmxlbmd0aCkgdGhyb3cgYCR7bXNnfSBubyBlbnR5IHNwZWNpZmllZGA7XG5cbiAgcmV0dXJuIHtcbiAgICBjb250ZXh0LFxuICAgIGRldnRvb2wsXG4gICAgZW50cnk6IGVudHJ5VW5zaGlmdC5jb25jYXQoZW50cnksIGVudHJ5UHVzaCkuZmlsdGVyKGUgPT4gZSksXG4gICAgZXh0ZXJuYWxzOiBwYWNrLmJ1aWx0aW5Nb2R1bGVzLmNvbmNhdChleHRlcm5hbHMpLFxuICAgIG1vZGUsXG4gICAgb3B0aW1pemF0aW9uLFxuICAgIHBsdWdpbnM6IChwbHVnaW5zLmNvbmNhdChiYXNlUGx1Z2lucykpLmZpbHRlcih4ID0+IHgpLFxuICAgIHJlc29sdmU6IHsgZXh0ZW5zaW9ucywgbWFpbkZpZWxkcyB9LFxuICAgIHN0YXRzLFxuICAgIHRhcmdldCxcblxuICAgIG91dHB1dDoge1xuICAgICAgcGF0aDogcGF0aERpc3QsXG4gICAgICBwdWJsaWNQYXRoLFxuICAgICAgLi4ub3V0cHV0RGVmYXVsdCxcbiAgICAgIC4uLm91dHB1dCxcbiAgICB9LFxuXG4gICAgbW9kdWxlOiB7XG4gICAgICBydWxlczogW1xuICAgICAgICBlc21Mb2FkZXIsXG4gICAgICAgIGpzTG9hZGVyLFxuICAgICAgICBjc3NJbnRlcm5hbExvYWRlcixcbiAgICAgICAgY3NzRXh0ZXJuYWxMb2FkZXIsXG4gICAgICAgIGZvbnRMb2FkZXIsXG4gICAgICAgIHN2Z0xvYWRlcixcbiAgICAgICAgaW1hZ2VMb2FkZXIsXG4gICAgICAgIHZpZGVvTG9hZGVyLFxuICAgICAgXS5maWx0ZXIoeCA9PiB4KVxuICAgIH0sXG5cbiAgICAuLi5vdmVycmlkZXMsXG4gIH1cbn1cbiJdfQ==